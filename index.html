<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Mapbox Project</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="./bootstrap.js"></script>
    <link
      href="./bootstrap.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant&display=swap" rel="stylesheet">
    
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size:16.0pt;
      }
      h2 {
        font-size:10.0pt;
      }
      h3 {
        margin: 10px;
        font-size: 1.2em;
      }
      h3 {
        font-size: 1em;
      }
      p {
        font-size: 0.85em;
        margin: 10px;
        text-align: left;
      }
      .map-overlay {
        /* display: none; */
        position: absolute;
        top: 0;
        left: 0;
        /* background: rgba(255, 255, 255, 0.8); */
        margin-left: 20px;
        margin-top: 20px;
        font-family: Arial, sans-serif;
        /* overflow: auto; */
        /* border-radius: 3px; */
      }
      .secondary-title {
        position: fixed;
        top: 100px;
        right: 10px;
        background-color: black;
        opacity: 70%;
        vertical-align: middle;
        /* height: 5%; */
        color: white;
        z-index: 99999;
        text-size-adjust: 6;
        font-family: 'Assistant';
        direction: rtl;
      }
      .map-title {
        position: fixed;
        top: 0;
        left: 35%;
        background-color: black;
        opacity: 50%;
        vertical-align: middle;
        /* height: 5%; */
        color: white;
        z-index: 99999;
        text-size-adjust: 14;
        font-family: 'Assistant';
        direction: rtl;
      }
      .full-image {
        position: fixed;
        /* margin: 0; */
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        /* left: 20%; */
        /* height: 90%; */
        /* width: 100%; */
        opacity: 95%;
        z-index: 99999;
        /* max-width: 500px;
        margin: auto;
        padding: 10px; */
        display: none;
      }
      .button {
        position: absolute;
        top: 50%;
        right: 92%;
        transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
        /* Center the content */
        align-items: center;
        display: flex;
        justify-content: center;

        /* Spacing */
        padding: 8px;
      }
      
      .button__arrow {
        /* Transparent background */
        background-color: transparent;

        /* Size */
        height: 12px;
        width: 12px;
      }

      .button__arrow--left {
        /* Edges */
        border-bottom: 1px solid rgba(0, 0, 0, 0.3);
        border-left: 1px solid rgba(0, 0, 0, 0.3);
        transform: translateX(25%) rotate(45deg);
      }
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
      #features {
        top: 0;
        height: 100px;
        margin-top: 20px;
        width: 250px;
      }
      #legend {
        padding: 10px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        line-height: 18px;
        height: 280px;
        top: 100%;
        margin-left: 20px;
        margin-top: 20px;
        width: 260px;
        position: relative;

      }
      .legend-key {
        display: inline-block;
        border-radius: 20%;
        width: 10px;
        height: 10px;
        margin-right: 5px;
        margin-left: 10px;
      }
      .icon {
        background: url('./checkpoints-15.svg');
        height: 15px;
        width: 15px;
        display: inline-block;
        margin-right: 2px;
        margin-left: 10px;
      }
      .triangle_icon {
        background: url('./triangle-blue-11.svg');
        height: 15px;
        width: 15px;
        display: inline-block;
        margin-right: 2px;
        margin-left: 10px;
      }
      /* The popup form - hidden by default */
      .form-popup {
        display: none;
        position: fixed;
        vertical-align: middle;
        bottom: 0;
        right: 15px;
        border: 3px solid #f1f1f1;
        z-index: 9;
        margin:4px, 4px;
        padding:4px;
        background-color: white;
        width: 560px;
        height: 560px;
        overflow-x: hidden;
        overflow-y: auto;
        text-align:justify;
        font-family: 'Assistant';
      }

      .form-popup button.btn-outline-secondary {
        left: 0;
      }

      .form-popup form {
        direction: rtl;
        text-align: right;
        font-family: 'Assistant';
      }

      /* Add styles to the form container */
      .form-container {
        width: 560;
        /* max-width: 300px; */
        padding: 10px;
        background-color: white;
      }
      .text-container {
        display: none;
        position: fixed;
        vertical-align: middle;
        bottom: 0;
        right: 15px;
        border: 3px solid #f1f1f1;
        z-index: 9;
        margin:4px, 4px;
        padding:4px;
        background-color: rgba(255,255,255, 0.6);
        text-align: right;
        width: 560px;
      }
      #close {
        /* float:right; */
        /* display:inline-block; */
        position: absolute;
        right: 0;
        top: 0;
        padding: 8px;
        background:white;
        border: none;
        width: 25px;
        align-items: center;
      }
      #close:hover {
        /* float:right; */
        /* display:inline-block; */
        position: absolute;
        right: 0;
        top: 0;
        padding: 8px;
        background:#ccc;
        color:#fff;
        width: 25px;
        align-items: center;
      }
      #enlarge {
        /* float:right; */
        /* display:inline-block; */
        position: absolute;
        right: 30px;
        top: 0;
        padding: 8px;
        background:white;
        border: none;
      }
      #enlarge:hover {
        /* float:right; */
        /* display:inline-block; */
        position: absolute;
        right: 30px;
        top: 0;
        padding: 8px;
        background:#ccc;
        color:#fff;
      }
      
      /* #close {
        background:white;
        border: none;
        position: absolute;
        top: 0;
        right: 0;
        align-items: center;
        display: flex;
        justify-content: center;

        padding: 8px;
      }
      #close:hover {
        background:#ccc;
        color:#fff;
        border: none;
        position: absolute;
        top: 0;
        right: 0;
        align-items: center;
        display: flex;
        justify-content: center;

        padding: 8px;
      } */
      div.scroll {
        margin:4px, 4px;
        padding:4px;
        background-color: green;
        width: 500px;
        height: 110px;
        overflow-x: hidden;
        overflow-y: auto;
        text-align:justify;
      }
      img {
        max-width: 100%;
        max-height: 100%;
      }
      audio {
        display: none;
        position: fixed;
        vertical-align: middle;
        bottom: 0;
        right: 15px;
        z-index: 9;
      }
      .mapboxgl-popup {
        font-family: 'Assistant';
        text-align: right;
        direction: rtl;
      }
      .mapboxgl-popup-content{
        /* background-color: rgb(31, 29, 29); */
        background-color: black;
        opacity: 70%;
        font-family: 'Assistant';
        text-align: right;
        direction: rtl;
        padding-right: 0px;
      }

      .mapboxgl-popup-content h3.h3_1{
        color: white;
      }

      .mapboxgl-popup-content b{
        color: white;
      }

      .mapboxgl-popup-content h3.h3_2{
        color: gray;
      }

      .mapboxgl-popup-content h2{
        color: gray;
      }

      .mapboxgl-popup-content p{
        color: white;
      }

      .mapboxgl-popup-anchor-top > .mapboxgl-popup-tip {
        /* border-top-color: aquamarine; */
        border: none;
      }

      .mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip {
        /* border-top-color: aquamarine; */
        border: none;
      }

      .mapboxgl-popup-close-button {
        color: white;
      }

    </style>
  </head>
  <script>

    var forms = [
      'Gagon_Addicts',
      'Gagon_Women',
      'Transition Apartment',
      "Hygiene Center",
      "The Platform",
      "Dizengoff Center",
      "Dirty Burger",
      "Synagogue Beit El",
      "Mati",
      "Natan",
      "Dizengoff  Square",
      "only_text"
    ]

    var formIdx = {
      '"Lasova"_Gagon_Addicts': 0,
      '"Lasova"_Gagon_Women': 1,
      '"Lasova"_Transition Apartment': 2,
      "Hygiene Center": 3,
      "The Platform": 4,
      "Dizengoff Center": 5,
      "Dirty Burger": 6,
      "Synagogue Beit El": 7,
      "Mati": 8,
      "Natan": 9,
      "Dizengoff  Square": 10,
      "only_text": 11
    }

    // var sources = {
    //   "Dizengoff  Square_in": [
    //     "images/Dizengoff Setion.pdf#view=Fit",
    //     "images/Zoom-in Section.pdf#view=Fit"
    //   ]
    // }
    var sources = {
      "Dizengoff  Square_in": "Dizengoff Setion.pdf",
      "Dizengoff  Square_in2": "Zoom-in Section.pdf"
    }
        
    // function openForm(idx) {
    //   var lst = [0, 1, 2, 3];
    //   lst.splice(idx, 1);
    //   document.getElementById(forms[lst[0]]).style.display = "none";
    //   document.getElementById(forms[lst[1]]).style.display = "none";
    //   document.getElementById(forms[lst[2]]).style.display = "none";
    //   document.getElementById(forms[idx]).style.display = "block";
    // }
    var layers = [];
    function openForm(idx) {
      for (i = 0; i < forms.length; i++) {
        if (i == idx) {
          console.log(forms[i]);
          document.getElementById(forms[i]).style.display = "block";
        }
        else {
          document.getElementById(forms[i]).style.display = "none";
        }
      }
    }

    function openImage(id) {
      document.getElementById(id).style.display = "block";
      // console.log(document.getElementById(id).children);
      closeForm();
    }

    function closeImage(id1, id2) {
      document.getElementById(id1).style.display = "none";
      openForm(formIdx[id2]);
    }

    function closeForm() {
      for (i = 0; i < forms.length; i++)
      {
        document.getElementById(forms[i]).style.display = "none";
      }
    }

    var relIdx = 0;
    // function changeSource(id, idx) {
    //   var current=document.getElementById(id);
    //   var clone=current.cloneNode(true);
    //   var source = sources[id][idx];
    //   clone.setAttribute('src',source);
    //   current.parentNode.replaceChild(clone,current)
    //   relIdx = 1 - relIdx;
    // }
    function changeSource(id1, id2) {
      document.getElementById(id2).style.display = "block";
      document.getElementById(id1).style.display = "none";
    }

    function accordionClick() {
      var vis = map.getLayer('3D').visibility;
      var isChecked = false;
      if (vis == 'visible')
        isChecked = true;
      for (i = 0; i < collapseOne.children.length; i++) {
        if (collapseOne.children[i].innerText == '3D') {
          collapseOne.children[i].children[0].checked = isChecked;
        }
      }
    }
  </script>
  <div class="map-title">
    <h1 style="padding-top: 5px; padding-right: 8px; padding-left: 8px; text-align: center;">כלי לקריאה מחודשת של תל-אביב מעיניהם של דרי הרחוב</h1>
  </div>
  <div class="secondary-title">
    <p style="padding-right: 2px; padding-left: 2px; text-align: center;">לחץ על הנקודות הצהובות להכרת הסיפורים האישיים</p>
  </div>
  <body>
    <div id="map"></div>
    <div class="map-overlay">
      <div class="accordion" id="accordionExample">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" onclick='accordionClick()'>
              מקרא
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse hide" aria-labelledby="headingOne"></div>
        </div>
      </div>
      
    </div>
    <div class="full-image" id="Mechurim">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Mechurim", "\"Lasova\"_Gagon_Addicts")'>x</button>
      <div id="Mechurim_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Mechurim_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Mechurim.pdf"}},
            metaData:{fileName: "Mechurim.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <div class="full-image" id="Women">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Women", "\"Lasova\"_Gagon_Women")'>x</button>
      <div id="Women_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Women_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Women.pdf"}},
            metaData:{fileName: "Women.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <div class="full-image" id="Dirat Maavar">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Dirat Maavar", "\"Lasova\"_Transition Apartment")'>x</button>
      <div id="Dirat Maavar_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Dirat Maavar_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Dirat Maavar.pdf"}},
            metaData:{fileName: "Dirat Maavar.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
   
    <div class="full-image" id="Dirty Burger img">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Dirty Burger img", "Dirty Burger")'>x</button>
      <div id="Dirty Burger img_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Dirty Burger img_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Dirty Burger.pdf"}},
            metaData:{fileName: "Dirty Burger.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <!-- https://drive.google.com/file/d/1FodN9dEg-fYmh659HAUIrqG4MjcNJV0O/preview -->
    <div class="full-image" id="Frishman 46">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Frishman 46", "Natan")'>x</button>
      <!-- <embed
        height="100%"
        width="100%" 
        src="images/Frishman 46.pdf#view=Fit">
      </embed> -->
      <div id="Frishman 46_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Frishman 46_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Frishman 46.pdf"}},
            metaData:{fileName: "Frishman 46.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <div class="full-image" id="Dizengoff  Square_in">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Dizengoff  Square_in", "Dizengoff  Square")'>x</button>
      <!-- <button class="arrow_button"></button> -->
      <button class="button" onclick="changeSource('Dizengoff  Square_in', 'Dizengoff  Square_in2')"><div class="button__arrow button__arrow--left"></div></button>
      <div id="Dizengoff  Square_in_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Dizengoff  Square_in_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Dizengoff Setion.pdf"}},
            metaData:{fileName: "Dizengoff Setion.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <div class="full-image" id="Dizengoff  Square_in2">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeImage("Dizengoff  Square_in2", "Dizengoff  Square")'>x</button>
      <!-- <button class="arrow_button"></button> -->
      <button class="button" onclick="changeSource('Dizengoff  Square_in2', 'Dizengoff  Square_in')"><div class="button__arrow button__arrow--left"></div></button>
      <!-- <embed
        id="Dizengoff  Square_in"
        height="100%"
        width="100%" 
        src="images/Dizengoff Setion.pdf#view=Fit">
      </embed> -->
      <div id="Dizengoff  Square_in2_in"></div>
      <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
      <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
          var adobeDCView = new AdobeDC.View({clientId: "9029a3f828a14ab9b10c9b799a7981d8", divId: "Dizengoff  Square_in2_in"});
          adobeDCView.previewFile({
            content:{location: {url: "https://studio-project-mid.github.io/mapbox/images/Zoom-in Section.pdf"}},
            metaData:{fileName: "Zoom-in Section.pdf"}
          }, {defaultViewMode: "FIT_PAGE", showAnnotationTools: false, showLeftHandPanel: false, 
            showDownloadPDF: false, showPrintPDF: false});
        });
      </script>
    </div>
    <!-- <div class="form-popup" id="present_form">
      <button id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container">
        <h1>YouTube video</h1>
      </form>
    </div>
    <div class="form-popup" id="near_future_form">
      <button id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container">
        <h1>Near Future</h1>
        <p>After a while, the control games in the area are on the rise - 
          The Israeli settlements are expanding while starting more "Pop-up settlements" (Tower and Stockade - "Homa u'migdal") 
          and places guarding towers inside the Palestinian settlements which are expanding by spreading olive groves - 
          The Indian communities gain power and resources, buy lands and builds temples.
        </p>
      </form>
    </div>
    <div class="form-popup" id="far_future_form">
      <button id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container">
        <h1>Far Future</h1>
        <p>Almost every part of the land is occupied by 3 groups of power.
          The control games and expantion in the area continues, this time also inside the groups themselves.
          The Indians claim lands by placing fences and building more and more temples, while the Israelies and the Palestinians continue the spatial expantion.
          The whole area is filled with collisions and conflicts.
        </p>
      </form>
    </div> -->
    <!-- <div class="form-popup" id="youtube_video">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container">
        <h1>Title</h1>
        <p>---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
        </p>
      </form>
      <iframe 
      width="560" 
      height="315" 
      src="https://www.youtube.com/embed/EouCk4vx5Zg" 
      title="YouTube video player" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen>
      </iframe>
      <form action="/action_page.php" class="form-container">
        <h1>Title</h1>
        <p>---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
          ---------- This is text ----------
        </p>
      </form>
      <img 
      src="tzipkush.jpg"
      onclick="openImage()"
      />

    </div> -->
    <div class="form-popup" id="Gagon_Addicts">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Mechurim")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Mechurim.pdf">
      </embed>
    </div>
    <div class="form-popup" id="Gagon_Women">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Women")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Women.pdf">
      </embed>
    </div>
    <div class="form-popup" id="Transition Apartment">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Dirat Maavar")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Dirat Maavar.pdf">
      </embed>
    </div>
    <audio controls id="Hygiene Center">
      <source src="audio/חביב_מרכז היגיינה.m4a" type="audio/wav">
    </audio>
    <audio controls id="The Platform">
      <source src="audio/יואב_יחידת דרי רחוב.mp3" type="audio/mp3">
    </audio>
    <div class="form-popup" id="Dizengoff Center">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <iframe 
      width="560" 
      height="315" 
      src="https://www.youtube.com/embed/R8xFDr03D-M" 
      title="Natan" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen>
      </iframe>
    </div>
    <div class="form-popup" id="Dirty Burger">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Dirty Burger img")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Dirty Burger.pdf">
      </embed>
    </div>
    <form action="/action_page.php" class="text-container" id="Synagogue Beit El">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <!-- <h1 style="text-align: center;">Title</h1> -->
      <p>״תשאלי אותי איפה אני אוכל בשבת, למרות שאני לא כל כך רעב בבוקר…חוף פרישמן קצת קרוב לבן יהודה יש בית כנסת של הקהילה הצרפתית…עכשיו, כל שבת אחרי שהם גומרים את התפילה הם עושים קידוש, עכשיו אני אוהב נורא חמין, אז כל שבת הם עושים בחצר אוכל, וזה מה שאני לוקח…״ (נתן, דר רחוב)
      </p>
    </form>

    <div class="form-popup" id="Mati">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <iframe 
      width="560" 
      height="315" 
      src="https://www.youtube.com/embed/HAVRlBJQ38M" 
      title="Mati" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen>
      </iframe>
    </div>
    <div class="form-popup" id="Natan">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Frishman 46")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Frishman 46.pdf">
      </embed>
    </div>
    <div class="form-popup" id="Dizengoff  Square">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <button type="button" class="btn btn-outline-secondary" id='enlarge' onclick='openImage("Dizengoff  Square_in")'>Enlarge</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
      <embed
        height="100%"
        width="100%" 
        src="images/Dizengoff Setion.pdf">
      </embed>
      <embed
        height="100%"
        width="100%" 
        src="images/Zoom-in Section.pdf">
      </embed>
    </div>
    <div class="form-popup" id="only_text" style="direction: rtl; text-align: right; width: 400px;">
      <button type="button" class="btn btn-outline-dark" id='close' onclick='closeForm()'>x</button>
      <form action="/action_page.php" class="form-container" id="text_form"></form>
    </div>
    
    <script>

      // define access token
      mapboxgl.accessToken = 'pk.eyJ1IjoiYWRpZ2FsaSIsImEiOiJja3dsc3ViOHYwMXNxMnBxdDRmOW1tcDRhIn0.01oFmibnj8b3erAu6aTXIg';
      mapboxgl.setRTLTextPlugin(
        'https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js',
        null,
        true // Lazy load the plugin
      );

      var flying = false;

      //create map
      var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/adigali/ckwluaunh2ymp14o5vwkekbgg' // map style URL from Mapbox Studio
        // zoom: 6
        
      });

      // var pos = [34.776, 32.058];
      var pos = [34.77551, 32.07435];

      // wait for map to load before adjusting it
      map.on('load', function () {
        // make a pointer cursor
        map.getCanvas().style.cursor = 'default';

        // make a pointer cursor
        map.getCanvas().style.cursor = 'default';

        map.flyTo({
          // These options control the ending camera position: centered at
          // the target, at zoom level 9, and north up.
          center: pos,
          zoom: 13,
          bearing: 0,
          
          // These options control the flight curve, making it move
          // slowly and zoom out almost completely before starting
          // to pan.
          speed: 0.2, // make the flying slow
          curve: 1, // change the speed at which it zooms out
          
          // This can be any easing function: it takes a number between
          // 0 and 1 and returns another number between 0 and 1.
          easing: (t) => t,
          
          // this animation is considered essential with respect to prefers-reduced-motion
          essential: true
        });

        const nav = new mapboxgl.NavigationControl({
          visualizePitch: true
        });
        map.addControl(nav, 'top-right');
        document.querySelector('.mapboxgl-ctrl-compass').addEventListener('click', () =>{
          for (i = 0; i < collapseOne.children.length; i++) {
            if (collapseOne.children[i].innerText == '3D') {
              collapseOne.children[i].children[0].checked = false;
            }
            map.setLayoutProperty(
              '3D',
              'visibility',
              'none'
            );
          }
        })

        // define layer names
        // var layers = [
        //   'Green Line',
        //   'West Bank Separation Barrier',
        //   'Palestinian Settlements',
        //   'Area A',
        //   'Area B',
        //   'Area C',
        //   'Settlements',
        //   'Tamil Settlements',
        //   'Closed Millitary Zones',
        //   'Declared State Lands',
        //   // 'Roads',
        //   'Checkpoints'
        // ];
        
        // var colors = [
        //   "hsl(342, 28%, 47%)",
        //   "hsl(0, 11%, 72%)",
        //   "hsl(0, 11%, 72%)",
        //   "hsl(232, 67%, 71%)",
        //   "hsl(94, 42%, 65%)",
        //   "hsl(0, 57%, 50%)",
        //   "hsl(52, 70%, 70%)"
        // ];


        var layers_map = map.getStyle().layers;
        console.log(layers_map);

        // var layers_acc = document.createElement('button');
        // layers_acc.className = 'accordion';
        // layers_acc.id = 'layers_acc';
        // layers_acc.innerHTML = 'Map Layers';

        // var tmp_div = document.createElement('div');
        //   tmp_div.className = 'panel';

        var line_div = document.createElement('div');
        line_div.className = 'accordion-body';
        const all_box = document.createElement('input');
        all_box.type = 'checkbox';
        all_box.checked = true;
        all_box.id = 'all_box';
        all_box.href = '#';
        all_box.textContent = 'all_box';
        all_box.className = 'active';

        all_box.onchange = function (e) {
          for (i = 1; i < collapseOne.children.length; i++)
          {
            const current_layer = collapseOne.children[i].children[0];
            if (this.checked == false) {
              current_layer.checked = false;
            } else {
              current_layer.checked = true;
            }
            const clickedLayer = current_layer.textContent;
            e.preventDefault();
            e.stopPropagation();
            
            const visibility = map.getLayoutProperty(
              clickedLayer,
              'visibility'
            );
            // Toggle layer visibility by changing the layout object's visibility property.
            if (visibility == 'visible' && current_layer.checked == false) {
                map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                this.className = '';
              } else {
                this.className = 'active';
                map.setLayoutProperty(
                  clickedLayer,
                  'visibility',
                  'visible'
                );
              }
            
          }
          
        };

        var all_title = document.createElement('span');
        all_title.innerHTML = 'כל השכבות';
        all_title.style = "font-size:10.0pt; margin-left:10px;"

        line_div.appendChild(all_box);
        line_div.appendChild(all_title);
        collapseOne.appendChild(line_div);

        function getLayerColor(layer) {
          console.log(layer);
          switch (layer.type) {
            case "line":
              if ("paint" in layer) {
                var lineColor = layer.paint["line-color"];
                if (Array.isArray(lineColor))
                  return lineColor[6];
                return lineColor;
              }
              else {
                return "hsl(0, 100%, 0%)";
              }
            case "fill":
              var fillColor = "hsl(0, 100%, 0%)";
              var fillPaint = layer.paint;
              if ("fill-color" in fillPaint) {
                fillColor = fillPaint["fill-color"];
              }
              else if ("fill-outline-color" in fillPaint) {
                fillColor = fillPaint["fill-outline-color"];
              }
              if (Array.isArray(fillColor))
                return fillColor[6];
              return fillColor;
            case "circle":
              var circleColor = "hsl(0, 100%, 0%)";
              if ("paint" in layer) {
                var circlePaint = layer.paint;
                if ("circle-color" in circlePaint) {
                  circleColor = circlePaint["circle-color"];
                  if (Array.isArray(circleColor))
                    return circleColor[5];
                }
                else if ("circle-stroke-color" in circlePaint){
                  circleColor = circlePaint["circle-stroke-color"];
                }
                if (Array.isArray(circleColor))
                  circleColor = circleColor[6];
              }
              return circleColor;
              
            case "fill-extrusion":
              return layer.paint["fill-extrusion-color"];
          }
        }

        var notInLegend = [
          'back-yard-stroke',
          'front-yard-stroke'
        ];

        var layerHebrewNames = {
          'sleeping-corners': 'מרחבי לינה',
          'informal': 'הזדמנויות',
          'formal': 'מענים מוסדיים',
          'green-areas-and-parks': 'גינות',
          'front-yard': 'חצר קדמית',
          'back-yard': 'חצר אחורית',
          'parking': 'חניונים',
          'business': 'חנויות',
          'light-rail': 'תוואי הרכבת הקלה',
          '3D': '3D',
          'strategic-axes': 'צירים אסטרטגיים'
        }

        // create legend
        for (i = 78; i < layers_map.length; i++) {
          if (!notInLegend.includes(layers_map[i].id)) {
            layers.push(layers_map[i].id);
            var layer = layers_map[i].id;
            var color = getLayerColor(layers_map[i]);
            var layerType = layers_map[i].type;
            // var color = colors[j];
            // console.log(layers_map[i].id + ", " + color);
            var item = document.createElement('div');
            item.id = 'item_' + layers_map[i].id;
            item.className = 'accordion-body';
            var key = document.createElement('span');
            key.className = 'legend-key';
            key.style.backgroundColor = color;
            if (layerType == 'circle') {
              key.style.borderRadius = '50%';
            }
            else if (layerType == 'line') {
              key.style.height = '2px';
              key.style.verticalAlign = 'middle';
            }
              
            const link = document.createElement('input');
            link.type = 'checkbox';
            link.id = layers_map[i].id;
            link.href = '#';
            link.textContent = layers_map[i].id;
            link.style = "margin-left:10px;"

            link.checked = true;
            link.className = 'active';

            var vis = 'visible';
            if (layers_map[i].id == '3D') {
              vis = 'none';
              link.checked = false;
            }
              
            map.setLayoutProperty(
              link.textContent,
              'visibility',
              vis
            );
            
            // Show or hide layer when the toggle is clicked.
            link.onchange = function (e) {
              const clickedLayer = this.textContent;
              e.preventDefault();
              e.stopPropagation();
              
              const visibility = map.getLayoutProperty(
                clickedLayer,
                'visibility'
              );
              
              // Toggle layer visibility by changing the layout object's visibility property.
              if (visibility == 'visible' && link.checked == false) {
                map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                this.className = '';
              } else {
                this.className = 'active';
                map.setLayoutProperty(
                  clickedLayer,
                  'visibility',
                  'visible'
                );
              }
            };

            var value = document.createElement('span');
            value.innerHTML = layerHebrewNames[layer];
            value.style = "font-size:10.0pt;"

            item.appendChild(link);
            item.appendChild(key);
            item.appendChild(value);
            collapseOne.appendChild(item);
          }
        }

        // layers_acc_title.addEventListener("click", function() {
        //   this.classList.toggle("active");
        //   for (i = 0; i < this.children.length; i++) {
        //     var panel = this.children[i];
        //     if (panel.style.maxHeight) {
        //       panel.style.maxHeight = null;
        //     } else {
        //       this.nextSibling
        //       panel.style.maxHeight = panel.scrollHeight + "px";
        //     }
        //   }
          
        // });

        // layers_acc.addEventListener("click", function() {
        //   this.classList.toggle("active");
        //   for (i = 0; i < this.children.length; i++) {
        //     var panel = this.children[i];
        //     if (panel.style.maxHeight) {
        //       panel.style.maxHeight = null;
        //     } else {
        //       panel.style.maxHeight = panel.scrollHeight + "px";
        //     }
        //   }
          
        // });

        // legend.appendChild(layers_acc);
        
        // var forms = ['present_form', 'near_future_form', 'far_future_form'];

        // function openForm(idx) {
        //   var lst = [0, 1, 2];
        //   lst.splice(idx, 1);
        //   document.getElementById(forms[lst[0]]).style.display = "none";
        //   document.getElementById(forms[lst[1]]).style.display = "none";
        //   document.getElementById(forms[idx]).style.display = "block";
        // }

        // function closeForm() {
        //   for (i = 0; i < forms.length; i++)
        //   {
        //     document.getElementById(forms[i]).style.display = "none";
        //   }
        // }

        // var periods = ['Current', 'Present', 'Near Future', 'Far Future'];

        // var time_filter = document.createElement('button');
        // time_filter.className = 'accordion2';
        // time_filter.id = 'filter';
        // time_filter.innerHTML = 'Choose Time Period';
        // for (i = 0; i < periods.length; i++) {
        //   var tmp_div = document.createElement('div');
        //   tmp_div.className = 'accordion-body';
        //   var tmp_radio = document.createElement('input');
        //   tmp_radio.type = 'radio';
        //   tmp_radio.id = periods[i];
        //   tmp_radio.name = 'time';
        //   tmp_radio.value = periods[i]
        //   // tmp_radio.onchange = "openForm()";
        //   var label = document.createElement('label');
        //   label.htmlFor = periods[i];
        //   label.innerHTML = periods[i];
        //   label.style = "margin-left: 10px; font-size:10.0pt;"
        //   if (i == 0)
        //     tmp_radio.checked = true;
        //   tmp_div.appendChild(tmp_radio);
        //   tmp_div.appendChild(label);
        //   collapseTwo.appendChild(tmp_div);
        // }
        

        // collapseTwo.addEventListener('change', function(e) {
        //   var time = e.target.value;
        //   // update the map filter
        //   var tamil_checkbox = document.getElementById('item_' + 'Tamil Settlements').children[0];
        //   if (time === periods[0]) {
        //     filterTime = ["match", ["get", "time"], ["far future", "near future"], false, true];
        //     tamil_checkbox.className = '';
        //     tamil_checkbox.checked = false;
        //     map.setLayoutProperty('Tamil Settlements', 'visibility', 'none');
        //     closeForm();
        //   } else if (time === periods[1]) {
        //     map.setLayoutProperty('Tamil Settlements', 'visibility', 'visible');
        //     filterTime = ["match", ["get", "time"], ["far future", "near future"], false, true];
        //     tamil_checkbox.className = 'active';
        //     tamil_checkbox.checked = true;
        //     openForm(0);
        //   } else if (time === periods[2]) {
        //     map.setLayoutProperty('Tamil Settlements', 'visibility', 'visible');
        //     filterTime = ["match", ["get", "time"], ["far future", "present"], false, true];
        //     tamil_checkbox.className = 'active';
        //     tamil_checkbox.checked = true;
        //     openForm(1);
        //   } else if (time === periods[3]) {
        //     map.setLayoutProperty('Tamil Settlements', 'visibility', 'visible');
        //     filterTime = ["match", ["get", "time"], ["present", "near future"], false, true];
        //     tamil_checkbox.className = 'active';
        //     tamil_checkbox.checked = true;
        //     openForm(2);
        //   } else {
        //     console.log('error');
        //   }
        //   map.setFilter('Settlements', ['all', filterTime]);
        //   map.setFilter('Palestinian Settlements', ['all', filterTime]);
        //   map.setFilter('Tamil Settlements', ['all', filterTime]);
        // });
        // layers_acc.appendChild(time_filter);

        // var radio = document.getElementsByName('time');
        // console.log(radio);
        // for (i = 0; i < radio.length; i++) {
        //   radio[i].addEventListener("change", function(e) {
        //     // var time = e.target.value;
        //     console.log(radio[i]);
        //     openForm();
        //   });
        // }
        

        // $('input[name="radioButton"]').on("click", function(e) {

        //   if (e.clientX === 0 && e.clientY === 0) {
        //       console.log("keyboard");
        //   } else {
        //       console.log("mouse");
        //   };
        // }

        // var test_layer = '';
        // youtube_video_popup = document.getElementById('youtube_video');
        // var popups = [];

        // for (i = 78; i < layers_map.length; i++) {
        //   popups.push(layers_map[i].id);

        //   var form = document.createElement('div');
        //   form.className = "form-popup";
        //   form.id = layers_map[i].id;

        //   var closeButton = document.createElement('button');
        //   closeButton.type = "button";
        //   closeButton.className = "btn btn-outline-dark";
        //   closeButton.id = "close";
        //   closeButton.onclick = 'closeForm()';
        //   closeButton.innerHTML = 'x';

        //   var text = document.createElement('form');
        //   text.action = "/action_page.php";
        //   text.className = "form-container";
        //   var title = document.createElement('h1');
        //   title.innerHTML = 'Title';
        //   var inText = document.createElement('p');
        //   inText.innerHTML = '---------- This is text ----------\n---------- This is text ----------\n---------- This is text ----------';
        //   text.appendChild(title);
        //   text.appendChild(inText);



        //   map.on('click', layers_map[i].id, (e) => {

        //     openForm();
        //   });
        // }

        var formToOpen = "";

        map.on('moveend', function(e){
          if(flying) {
            openForm(formToOpen);
            map.fire('flyend');
          }
        });
        
        map.on('flystart', function(){
          flying = true;
        });
        map.on('flyend', function(){
          flying = false;
        });

        function flyToFunc(pos) {
          for (i = 0; i < collapseOne.children.length; i++) {
            if (collapseOne.children[i].innerText == '3D') {
              collapseOne.children[i].children[0].checked = true;
            }
            map.setLayoutProperty(
              '3D',
              'visibility',
              'visible'
            );
            
          }
          map.flyTo({
            // These options control the ending camera position: centered at
            // the target, at zoom level 9, and north up.
            center: pos,
            zoom: 16,
            bearing: 0,
            pitch: 60,
            
            // These options control the flight curve, making it move
            // slowly and zoom out almost completely before starting
            // to pan.
            speed: 0.3, // make the flying slow
            curve: 1, // change the speed at which it zooms out
            
            // This can be any easing function: it takes a number between
            // 0 and 1 and returns another number between 0 and 1.
            easing: (t) => t,
            
            // this animation is considered essential with respect to prefers-reduced-motion
            essential: true
          });
          map.fire('flystart');
        }
        
        function addTextToDiv(properties) {

        }

        function updateTextDiv(divId, properties) {

          var textForm = document.getElementById(divId).querySelector('#text_form');
          if (textForm != undefined) {
            var name = document.createElement('h3');
            name.innerHTML = 'שם<br><b>' +
                              properties["name_he"] +
                              '</b></br>';
            var sleeping = document.createElement('h3');
            sleeping.innerHTML = 'מרחב לינה<br><b>' +
                              properties["sleeping corner"] +
                              '</b></br>';
            var description = document.createElement('h3');
            description.innerHTML = '<b>' + properties["description"] + '</b>';
            if (textForm.children.length > 0) {
              textForm.replaceChild(name, textForm.children[0]);
              textForm.replaceChild(sleeping, textForm.children[1]);
              textForm.replaceChild(description, textForm.children[2]);
            }
            else {
              textForm.appendChild(name);
              textForm.appendChild(sleeping);
              textForm.appendChild(description);
            }
          }
        }

        for (i = 0; i < layers.length; i++) {
          map.on('click', layers[i], (e) => {
            console.log(e.features[0].layer['id']);
            var prop = e.features[0].properties["name"];
            if (prop in formIdx) {
              updateTextDiv(forms[formIdx[prop]], e.features[0].properties);
              // var timeOutVal = 0;
              if (prop == "Dizengoff  Square") {
                flyToFunc(e.features[0].geometry.coordinates);
                formToOpen = formIdx[prop];
                // timeOutVal = 5000;
              }
              else {
                openForm(formIdx[prop]);
              }
              // setTimeout(() => openForm(formIdx[prop]), timeOutVal);
            }
            else if (e.features[0].layer['id'] == 'sleeping-corners') {
              updateTextDiv('only_text', e.features[0].properties);
              openForm(formIdx['only_text']);
            }
          });
  
          map.on('mouseenter', layers[i], () => {
            map.getCanvas().style.cursor = 'pointer';
          });
          
          // Change the cursor back to a pointer
          // when it leaves the states layer.
          map.on('mouseleave', layers[i], () => {
            map.getCanvas().style.cursor = '';
          });
        }

       /* map.on('click', 'formal', (e) => {
          var prop = e.features[0].properties["Official institutions"];
          console.log(prop);
          if (prop == '"Lasova"_Gagon_Addicts') {
            openForm(0);
          } 
          else if (prop == '"Lasova"_Gagon_Women') {
            openForm(1);
          }
          else if (prop == '"Lasova"_Transition Apartment') {
            openForm(2);
          }
          else if (prop == 'Hygiene Center') {
            openForm(3);
          }
          else if (prop == 'The Platform') {
            openForm(4);
          }
        }); 

        map.on('mouseenter', 'formal', () => {
          map.getCanvas().style.cursor = 'pointer';
        });
        
        // Change the cursor back to a pointer
        // when it leaves the states layer.
        map.on('mouseleave', 'formal', () => {
          map.getCanvas().style.cursor = '';
        }); 



        map.on('click', 'informal', (e) => {
          var prop = e.features[0].properties["Informal Programs"];
          console.log(prop);
          if (prop == 'Dizengoff Center') {
            openForm(5);
          } 
          else if (prop == 'Dirty Burger') {
            openForm(6);
          }
          else if (prop == 'Synagogue Beit El') {
            openForm(7);
          }
        });

        map.on('mouseenter', 'informal', () => {
          map.getCanvas().style.cursor = 'pointer';
        });
        
        // Change the cursor back to a pointer
        // when it leaves the states layer.
        map.on('mouseleave', 'informal', () => {
          map.getCanvas().style.cursor = '';
        });



        map.on('click', 'sleeping-corners', (e) => {
          var prop = e.features[0].properties["Sleeping Corner"];
          console.log(prop);
          if (prop == 'Mati') {
            openForm(8);
          } 
          else if (prop == 'Natan') {
            openForm(9);
          }
        });

        map.on('mouseenter', 'sleeping-corners', () => {
          map.getCanvas().style.cursor = 'pointer';
        });*/
        
        
        /*map.on('mouseleave', 'sleeping-corners', () => {
          map.getCanvas().style.cursor = '';
        });*/ 

        function removeMapLayer(layerId) {
          console.log(collapseOne);
          for (i = 0; i < collapseOne.children.length; i++) {
            if (collapseOne.children[i].children[0].id == layerId) {
              collapseOne.children[i].remove();
              map.getLayer(layerId).visibility = 'none';
            }
          }
        }
        
      // Remove when needed!!!
      removeMapLayer('night-policy-in-leisure-areas');

      var noPopupLayers = [
        '3D',
        'back-yard',
        'front-yard',
        'business',
        'parking',
        'green-areas-and-parks'
      ];

      function hoverPopupMove(popup) {
        map.on('mousemove', function (e) {
            var features = map.queryRenderedFeatures(e.point, {
              layers: layers
            });
            if (!features.length) {
              return;
            }
            var feature = features[0];
            if (!(noPopupLayers.includes(feature.layer.id))) {
              var title = feature.properties["name_he"] != undefined ? feature.properties["name_he"] : layerHebrewNames[feature.layer.id];
              var htmlText = '<h3 class="h3_1"><b>' +
                              title +
                              '</b></h3>' +
                              '<p>'  +
                              layerHebrewNames[feature.layer.id] +
                              '</p>';
              if (feature.layer.id == 'sleeping-corners') {
                htmlText =  '<h3 class="h3_2">שם' + 
                            '<br><b>' +
                            feature.properties["name_he"] +
                            '</b></br></h3>' +
                            '<h3 class="h3_2">מרחב לינה' + 
                            '<br><b>' +
                            feature.properties["sleeping corner"] +
                            '</b></br></h3>' +
                            '<h3 class="h3_1"><b>' +
                            feature.properties["description"] +
                            '</b></h3>';
                popup.setMaxWidth('240px');
              }
              else if (feature.layer.id == 'strategic-axes' && "tsug" in feature.properties) {
                htmlText =  '<h3><b>' +
                            feature.properties["name_he"] +
                            '</b></h3>' +
                            '<h3 class="h3_2">שעות פעילות' + 
                            '<br><b>' +
                            feature.properties["tsug"] +
                            '</b></br></h3>';
                popup.setMaxWidth('240px');
              }
              popup.setLngLat(e.lngLat)
              .setHTML(htmlText)
              .addTo(map);
            }
            else {
              popup.remove();
            }
        });
        map.on('mouseleave', function(e) {
          popup.remove();
        });
      }
      
      var popup = new mapboxgl.Popup({ offset: [0, -15], closeOnMove: true, closeButton: false });
      hoverPopupMove(popup);

      

      });
    </script>
  </body>
</html>



